{"ast":null,"code":"/**\n    * @license\n    * Copyright 2020 Google LLC. All Rights Reserved.\n    * Licensed under the Apache License, Version 2.0 (the \"License\");\n    * you may not use this file except in compliance with the License.\n    * You may obtain a copy of the License at\n    *\n    * http://www.apache.org/licenses/LICENSE-2.0\n    *\n    * Unless required by applicable law or agreed to in writing, software\n    * distributed under the License is distributed on an \"AS IS\" BASIS,\n    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    * See the License for the specific language governing permissions and\n    * limitations under the License.\n    * =============================================================================\n    */\nimport { ones, scalar, tidy, tensor2d, util } from \"@tensorflow/tfjs-core\";\nimport { loadGraphModel } from \"@tensorflow/tfjs-converter\";\n\nfunction __awaiter(t, e, n, r) {\n  return new (n || (n = Promise))(function (o, i) {\n    function s(t) {\n      try {\n        a(r.next(t));\n      } catch (t) {\n        i(t);\n      }\n    }\n\n    function u(t) {\n      try {\n        a(r.throw(t));\n      } catch (t) {\n        i(t);\n      }\n    }\n\n    function a(t) {\n      t.done ? o(t.value) : new n(function (e) {\n        e(t.value);\n      }).then(s, u);\n    }\n\n    a((r = r.apply(t, e || [])).next());\n  });\n}\n\nfunction __generator(t, e) {\n  var n,\n      r,\n      o,\n      i,\n      s = {\n    label: 0,\n    sent: function () {\n      if (1 & o[0]) throw o[1];\n      return o[1];\n    },\n    trys: [],\n    ops: []\n  };\n  return i = {\n    next: u(0),\n    throw: u(1),\n    return: u(2)\n  }, \"function\" == typeof Symbol && (i[Symbol.iterator] = function () {\n    return this;\n  }), i;\n\n  function u(i) {\n    return function (u) {\n      return function (i) {\n        if (n) throw new TypeError(\"Generator is already executing.\");\n\n        for (; s;) try {\n          if (n = 1, r && (o = 2 & i[0] ? r.return : i[0] ? r.throw || ((o = r.return) && o.call(r), 0) : r.next) && !(o = o.call(r, i[1])).done) return o;\n\n          switch (r = 0, o && (i = [2 & i[0], o.value]), i[0]) {\n            case 0:\n            case 1:\n              o = i;\n              break;\n\n            case 4:\n              return s.label++, {\n                value: i[1],\n                done: !1\n              };\n\n            case 5:\n              s.label++, r = i[1], i = [0];\n              continue;\n\n            case 7:\n              i = s.ops.pop(), s.trys.pop();\n              continue;\n\n            default:\n              if (!(o = (o = s.trys).length > 0 && o[o.length - 1]) && (6 === i[0] || 2 === i[0])) {\n                s = 0;\n                continue;\n              }\n\n              if (3 === i[0] && (!o || i[1] > o[0] && i[1] < o[3])) {\n                s.label = i[1];\n                break;\n              }\n\n              if (6 === i[0] && s.label < o[1]) {\n                s.label = o[1], o = i;\n                break;\n              }\n\n              if (o && s.label < o[2]) {\n                s.label = o[2], s.ops.push(i);\n                break;\n              }\n\n              o[2] && s.ops.pop(), s.trys.pop();\n              continue;\n          }\n\n          i = e.call(t, s);\n        } catch (t) {\n          i = [6, t], r = 0;\n        } finally {\n          n = o = 0;\n        }\n\n        if (5 & i[0]) throw i[1];\n        return {\n          value: i[0] ? i[1] : void 0,\n          done: !0\n        };\n      }([i, u]);\n    };\n  }\n}\n\nfunction __values(t) {\n  var e = \"function\" == typeof Symbol && t[Symbol.iterator],\n      n = 0;\n  return e ? e.call(t) : {\n    next: function () {\n      return t && n >= t.length && (t = void 0), {\n        value: t && t[n++],\n        done: !t\n      };\n    }\n  };\n}\n\nfunction __read(t, e) {\n  var n = \"function\" == typeof Symbol && t[Symbol.iterator];\n  if (!n) return t;\n  var r,\n      o,\n      i = n.call(t),\n      s = [];\n\n  try {\n    for (; (void 0 === e || e-- > 0) && !(r = i.next()).done;) s.push(r.value);\n  } catch (t) {\n    o = {\n      error: t\n    };\n  } finally {\n    try {\n      r && !r.done && (n = i.return) && n.call(i);\n    } finally {\n      if (o) throw o.error;\n    }\n  }\n\n  return s;\n}\n\nvar SEPERATOR = \"‚ñÅ\",\n    UNK_INDEX = 100,\n    CLS_INDEX = 101,\n    CLS_TOKEN = \"[CLS]\",\n    SEP_INDEX = 102,\n    SEP_TOKEN = \"[SEP]\",\n    NFKC_TOKEN = \"NFKC\",\n    VOCAB_BASE = \"https://tfhub.dev/tensorflow/tfjs-model/mobilebert/1/\",\n    VOCAB_URL = VOCAB_BASE + \"processed_vocab.json?tfjs-format=file\",\n    TrieNode = function () {\n  function t(t) {\n    this.key = t, this.children = {}, this.end = !1;\n  }\n\n  return t.prototype.getWord = function () {\n    for (var t = [], e = this; null != e;) null != e.key && t.unshift(e.key), e = e.parent;\n\n    return [t, this.score, this.index];\n  }, t;\n}(),\n    Trie = function () {\n  function t() {\n    this.root = new TrieNode(null);\n  }\n\n  return t.prototype.insert = function (t, e, n) {\n    var r,\n        o,\n        i = this.root,\n        s = [];\n\n    try {\n      for (var u = __values(t), a = u.next(); !a.done; a = u.next()) {\n        var l = a.value;\n        s.push(l);\n      }\n    } catch (t) {\n      r = {\n        error: t\n      };\n    } finally {\n      try {\n        a && !a.done && (o = u.return) && o.call(u);\n      } finally {\n        if (r) throw r.error;\n      }\n    }\n\n    for (var c = 0; c < s.length; c++) null == i.children[s[c]] && (i.children[s[c]] = new TrieNode(s[c]), i.children[s[c]].parent = i), i = i.children[s[c]], c === s.length - 1 && (i.end = !0, i.score = e, i.index = n);\n  }, t.prototype.find = function (t) {\n    for (var e = this.root, n = 0; n < t.length && null != e;) e = e.children[t[n]], n++;\n\n    return e;\n  }, t;\n}();\n\nfunction isWhitespace(t) {\n  return /\\s/.test(t);\n}\n\nfunction isInvalid(t) {\n  return 0 === t.charCodeAt(0) || 65533 === t.charCodeAt(0);\n}\n\nvar punctuations = \"[~`!@#$%^&*(){}[];:\\\"'<,.>?/\\\\|-_+=\";\n\nfunction isPunctuation(t) {\n  return -1 !== punctuations.indexOf(t);\n}\n\nvar BertTokenizer = function () {\n  function t() {}\n\n  return t.prototype.load = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t, e, n;\n      return __generator(this, function (r) {\n        switch (r.label) {\n          case 0:\n            return t = this, [4, this.loadVocab()];\n\n          case 1:\n            for (t.vocab = r.sent(), this.trie = new Trie(), e = 999; e < this.vocab.length; e++) n = this.vocab[e], this.trie.insert(n, 1, e);\n\n            return [2];\n        }\n      });\n    });\n  }, t.prototype.loadVocab = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (t) {\n        return [2, util.fetch(VOCAB_URL).then(function (t) {\n          return t.json();\n        })];\n      });\n    });\n  }, t.prototype.processInput = function (t) {\n    for (var e = this, n = [], r = 0, o = this.cleanText(t, n).split(\" \").map(function (t) {\n      t = t.toLowerCase();\n      var o = e.runSplitOnPunc(t, r, n);\n      return r += t.length + 1, o;\n    }), i = [], s = 0; s < o.length; s++) i = i.concat(o[s]);\n\n    return i;\n  }, t.prototype.cleanText = function (t, e) {\n    var n,\n        r,\n        o = [],\n        i = 0,\n        s = 0;\n\n    try {\n      for (var u = __values(t), a = u.next(); !a.done; a = u.next()) {\n        var l = a.value;\n        if (isInvalid(l)) i += l.length;else {\n          if (isWhitespace(l)) {\n            if (!(o.length > 0 && \" \" !== o[o.length - 1])) {\n              i += l.length;\n              continue;\n            }\n\n            o.push(\" \"), e[s] = i, i += l.length;\n          } else o.push(l), e[s] = i, i += l.length;\n\n          s++;\n        }\n      }\n    } catch (t) {\n      n = {\n        error: t\n      };\n    } finally {\n      try {\n        a && !a.done && (r = u.return) && r.call(u);\n      } finally {\n        if (n) throw n.error;\n      }\n    }\n\n    return o.join(\"\");\n  }, t.prototype.runSplitOnPunc = function (t, e, n) {\n    var r,\n        o,\n        i = [],\n        s = !0;\n\n    try {\n      for (var u = __values(t), a = u.next(); !a.done; a = u.next()) {\n        var l = a.value;\n        isPunctuation(l) ? (i.push({\n          text: l,\n          index: n[e]\n        }), e += l.length, s = !0) : (s && (i.push({\n          text: \"\",\n          index: n[e]\n        }), s = !1), i[i.length - 1].text += l, e += l.length);\n      }\n    } catch (t) {\n      r = {\n        error: t\n      };\n    } finally {\n      try {\n        a && !a.done && (o = u.return) && o.call(u);\n      } finally {\n        if (r) throw r.error;\n      }\n    }\n\n    return i;\n  }, t.prototype.tokenize = function (t) {\n    var e,\n        n,\n        r = [],\n        o = this.processInput(t);\n    o.forEach(function (t) {\n      t.text !== CLS_TOKEN && t.text !== SEP_TOKEN && (t.text = \"\" + SEPERATOR + t.text.normalize(NFKC_TOKEN));\n    });\n\n    for (var i = 0; i < o.length; i++) {\n      var s = [];\n\n      try {\n        for (var u = (e = void 0, __values(o[i].text)), a = u.next(); !a.done; a = u.next()) {\n          var l = a.value;\n          s.push(l);\n        }\n      } catch (t) {\n        e = {\n          error: t\n        };\n      } finally {\n        try {\n          a && !a.done && (n = u.return) && n.call(u);\n        } finally {\n          if (e) throw e.error;\n        }\n      }\n\n      for (var c = !1, h = 0, f = [], p = s.length; h < p;) {\n        for (var d = p, _ = void 0; h < d;) {\n          var v = s.slice(h, d).join(\"\"),\n              g = this.trie.find(v);\n\n          if (null != g && null != g.end) {\n            _ = g.getWord()[2];\n            break;\n          }\n\n          d -= 1;\n        }\n\n        if (null == _) {\n          c = !0;\n          break;\n        }\n\n        f.push(_), h = d;\n      }\n\n      c ? r.push(UNK_INDEX) : r = r.concat(f);\n    }\n\n    return r;\n  }, t;\n}();\n\nfunction loadTokenizer() {\n  return __awaiter(this, void 0, void 0, function () {\n    var t;\n    return __generator(this, function (e) {\n      switch (e.label) {\n        case 0:\n          return [4, (t = new BertTokenizer()).load()];\n\n        case 1:\n          return e.sent(), [2, t];\n      }\n    });\n  });\n}\n\nvar MODEL_URL = \"https://tfhub.dev/tensorflow/tfjs-model/mobilebert/1\",\n    INPUT_SIZE = 384,\n    MAX_ANSWER_LEN = 32,\n    MAX_QUERY_LEN = 64,\n    MAX_SEQ_LEN = 384,\n    PREDICT_ANSWER_NUM = 5,\n    OUTPUT_OFFSET = 1,\n    NO_ANSWER_THRESHOLD = 4.3980759382247925,\n    QuestionAndAnswerImpl = function () {\n  function t(t) {\n    this.modelConfig = t, null == this.modelConfig && (this.modelConfig = {\n      modelUrl: MODEL_URL,\n      fromTFHub: !0\n    }), null == this.modelConfig.fromTFHub && (this.modelConfig.fromTFHub = !1);\n  }\n\n  return t.prototype.process = function (t, e, n, r, o) {\n    void 0 === o && (o = 128), t = (t = t.replace(/\\?/g, \"\")).trim(), t += \"?\";\n    var i = this.tokenizer.tokenize(t);\n    if (i.length > n) throw new Error(\"The length of question token exceeds the limit (\" + n + \").\");\n\n    for (var s = this.tokenizer.processInput(e.trim()), u = [], a = [], l = 0; l < s.length; l++) for (var c = s[l].text, h = this.tokenizer.tokenize(c), f = 0; f < h.length; f++) {\n      var p = h[f];\n      u.push(l), a.push(p);\n    }\n\n    for (var d = r - i.length - 3, _ = [], v = 0; v < a.length;) {\n      var g = a.length - v;\n      if (g > d && (g = d), _.push({\n        start: v,\n        length: g\n      }), v + g === a.length) break;\n      v += Math.min(g, o);\n    }\n\n    return _.map(function (t) {\n      var e = [],\n          n = [],\n          o = {};\n      e.push(CLS_INDEX), n.push(0);\n\n      for (var l = 0; l < i.length; l++) {\n        var c = i[l];\n        e.push(c), n.push(0);\n      }\n\n      e.push(SEP_INDEX), n.push(0);\n\n      for (l = 0; l < t.length; l++) {\n        var h = l + t.start,\n            f = a[h];\n        e.push(f), n.push(1), o[e.length] = u[h];\n      }\n\n      e.push(SEP_INDEX), n.push(1);\n\n      for (var p = e, d = p.map(function (t) {\n        return 1;\n      }); p.length < r;) p.push(0), d.push(0), n.push(0);\n\n      return {\n        inputIds: p,\n        inputMask: d,\n        segmentIds: n,\n        origTokens: s,\n        tokenToOrigMap: o\n      };\n    });\n  }, t.prototype.load = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var t, e, n, r, o;\n      return __generator(this, function (i) {\n        switch (i.label) {\n          case 0:\n            return t = this, [4, loadGraphModel(this.modelConfig.modelUrl, {\n              fromTFHub: this.modelConfig.fromTFHub\n            })];\n\n          case 1:\n            return t.model = i.sent(), e = ones([1, INPUT_SIZE], \"int32\"), n = ones([1, INPUT_SIZE], \"int32\"), r = ones([1, INPUT_SIZE], \"int32\"), this.model.execute({\n              input_ids: e,\n              segment_ids: n,\n              input_mask: r,\n              global_step: scalar(1, \"int32\")\n            }), o = this, [4, loadTokenizer()];\n\n          case 2:\n            return o.tokenizer = i.sent(), [2];\n        }\n      });\n    });\n  }, t.prototype.findAnswers = function (t, e) {\n    return __awaiter(this, void 0, void 0, function () {\n      var n,\n          r,\n          o,\n          i,\n          s,\n          u,\n          a,\n          l,\n          c,\n          h,\n          f = this;\n      return __generator(this, function (p) {\n        switch (p.label) {\n          case 0:\n            if (null == t || null == e) throw new Error(\"The input to findAnswers call is null, please pass a string as input.\");\n            return n = this.process(t, e, MAX_QUERY_LEN, MAX_SEQ_LEN), r = n.map(function (t) {\n              return t.inputIds;\n            }), o = n.map(function (t) {\n              return t.segmentIds;\n            }), i = n.map(function (t) {\n              return t.inputMask;\n            }), s = scalar(1, \"int32\"), u = n.length, a = tidy(function () {\n              var t = tensor2d(r, [u, INPUT_SIZE], \"int32\"),\n                  e = tensor2d(o, [u, INPUT_SIZE], \"int32\"),\n                  n = tensor2d(i, [u, INPUT_SIZE], \"int32\");\n              return f.model.execute({\n                input_ids: t,\n                segment_ids: e,\n                input_mask: n,\n                global_step: s\n              }, [\"start_logits\", \"end_logits\"]);\n            }), [4, Promise.all([a[0].array(), a[1].array()])];\n\n          case 1:\n            for (l = p.sent(), s.dispose(), a[0].dispose(), a[1].dispose(), c = [], h = 0; h < u; h++) c.push(this.getBestAnswers(l[0][h], l[1][h], n[h].origTokens, n[h].tokenToOrigMap, e, h));\n\n            return [2, c.reduce(function (t, e) {\n              return t.concat(e);\n            }, []).sort(function (t, e) {\n              return e.score - t.score;\n            }).slice(0, PREDICT_ANSWER_NUM)];\n        }\n      });\n    });\n  }, t.prototype.getBestAnswers = function (t, e, n, r, o, i) {\n    var s;\n    void 0 === i && (i = 0);\n    var u = this.getBestIndex(t),\n        a = this.getBestIndex(e),\n        l = [];\n    u.forEach(function (n) {\n      a.forEach(function (o) {\n        r[n] && r[o] && o >= n && o - n + 1 < MAX_ANSWER_LEN && l.push({\n          start: n,\n          end: o,\n          score: t[n] + e[o]\n        });\n      });\n    }), l.sort(function (t, e) {\n      return e.score - t.score;\n    });\n\n    for (var c = [], h = 0; h < l.length && !(h >= PREDICT_ANSWER_NUM || l[h].score < NO_ANSWER_THRESHOLD); h++) {\n      var f = \"\",\n          p = 0,\n          d = 0;\n      l[h].start > 0 ? (f = (s = __read(this.convertBack(n, r, l[h].start, l[h].end, o), 3))[0], p = s[1], d = s[2]) : f = \"\", c.push({\n        text: f,\n        score: l[h].score,\n        startIndex: p,\n        endIndex: d\n      });\n    }\n\n    return c;\n  }, t.prototype.getBestIndex = function (t) {\n    for (var e = [], n = 0; n < MAX_SEQ_LEN; n++) e.push([n, n, t[n]]);\n\n    e.sort(function (t, e) {\n      return e[2] - t[2];\n    });\n    var r = [];\n\n    for (n = 0; n < PREDICT_ANSWER_NUM; n++) r.push(e[n][0]);\n\n    return r;\n  }, t.prototype.convertBack = function (t, e, n, r, o) {\n    var i = r + OUTPUT_OFFSET,\n        s = e[n + OUTPUT_OFFSET],\n        u = e[i],\n        a = t[s].index,\n        l = u < t.length - 1 ? t[u + 1].index - 1 : t[u].index + t[u].text.length;\n    return [o.slice(a, l + 1).trim(), a, l];\n  }, t;\n}();\n\nfunction load(t) {\n  return __awaiter(this, void 0, void 0, function () {\n    var e;\n    return __generator(this, function (n) {\n      switch (n.label) {\n        case 0:\n          return [4, (e = new QuestionAndAnswerImpl(t)).load()];\n\n        case 1:\n          return n.sent(), [2, e];\n      }\n    });\n  });\n}\n\nvar version = \"1.0.0\";\nexport { load, version };","map":{"version":3,"sources":["/Users/akhand/Developer/power-search/quickstart-react/node_modules/@tensorflow-models/qna/dist/qna.esm.js"],"names":["ones","scalar","tidy","tensor2d","util","loadGraphModel","__awaiter","t","e","n","r","Promise","o","i","s","a","next","u","throw","done","value","then","apply","__generator","label","sent","trys","ops","return","Symbol","iterator","TypeError","call","pop","length","push","__values","__read","error","SEPERATOR","UNK_INDEX","CLS_INDEX","CLS_TOKEN","SEP_INDEX","SEP_TOKEN","NFKC_TOKEN","VOCAB_BASE","VOCAB_URL","TrieNode","key","children","end","prototype","getWord","unshift","parent","score","index","Trie","root","insert","l","c","find","isWhitespace","test","isInvalid","charCodeAt","punctuations","isPunctuation","indexOf","BertTokenizer","load","loadVocab","vocab","trie","fetch","json","processInput","cleanText","split","map","toLowerCase","runSplitOnPunc","concat","join","text","tokenize","forEach","normalize","h","f","p","d","_","v","slice","g","loadTokenizer","MODEL_URL","INPUT_SIZE","MAX_ANSWER_LEN","MAX_QUERY_LEN","MAX_SEQ_LEN","PREDICT_ANSWER_NUM","OUTPUT_OFFSET","NO_ANSWER_THRESHOLD","QuestionAndAnswerImpl","modelConfig","modelUrl","fromTFHub","process","replace","trim","tokenizer","Error","start","Math","min","inputIds","inputMask","segmentIds","origTokens","tokenToOrigMap","model","execute","input_ids","segment_ids","input_mask","global_step","findAnswers","all","array","dispose","getBestAnswers","reduce","sort","getBestIndex","convertBack","startIndex","endIndex","version"],"mappings":"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","sourcesContent":["/**\n    * @license\n    * Copyright 2020 Google LLC. All Rights Reserved.\n    * Licensed under the Apache License, Version 2.0 (the \"License\");\n    * you may not use this file except in compliance with the License.\n    * You may obtain a copy of the License at\n    *\n    * http://www.apache.org/licenses/LICENSE-2.0\n    *\n    * Unless required by applicable law or agreed to in writing, software\n    * distributed under the License is distributed on an \"AS IS\" BASIS,\n    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    * See the License for the specific language governing permissions and\n    * limitations under the License.\n    * =============================================================================\n    */\nimport{ones,scalar,tidy,tensor2d,util}from\"@tensorflow/tfjs-core\";import{loadGraphModel}from\"@tensorflow/tfjs-converter\";function __awaiter(t,e,n,r){return new(n||(n=Promise))(function(o,i){function s(t){try{a(r.next(t))}catch(t){i(t)}}function u(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(s,u)}a((r=r.apply(t,e||[])).next())})}function __generator(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},\"function\"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError(\"Generator is already executing.\");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}function __values(t){var e=\"function\"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function __read(t,e){var n=\"function\"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s}var SEPERATOR=\"‚ñÅ\",UNK_INDEX=100,CLS_INDEX=101,CLS_TOKEN=\"[CLS]\",SEP_INDEX=102,SEP_TOKEN=\"[SEP]\",NFKC_TOKEN=\"NFKC\",VOCAB_BASE=\"https://tfhub.dev/tensorflow/tfjs-model/mobilebert/1/\",VOCAB_URL=VOCAB_BASE+\"processed_vocab.json?tfjs-format=file\",TrieNode=function(){function t(t){this.key=t,this.children={},this.end=!1}return t.prototype.getWord=function(){for(var t=[],e=this;null!=e;)null!=e.key&&t.unshift(e.key),e=e.parent;return[t,this.score,this.index]},t}(),Trie=function(){function t(){this.root=new TrieNode(null)}return t.prototype.insert=function(t,e,n){var r,o,i=this.root,s=[];try{for(var u=__values(t),a=u.next();!a.done;a=u.next()){var l=a.value;s.push(l)}}catch(t){r={error:t}}finally{try{a&&!a.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}for(var c=0;c<s.length;c++)null==i.children[s[c]]&&(i.children[s[c]]=new TrieNode(s[c]),i.children[s[c]].parent=i),i=i.children[s[c]],c===s.length-1&&(i.end=!0,i.score=e,i.index=n)},t.prototype.find=function(t){for(var e=this.root,n=0;n<t.length&&null!=e;)e=e.children[t[n]],n++;return e},t}();function isWhitespace(t){return/\\s/.test(t)}function isInvalid(t){return 0===t.charCodeAt(0)||65533===t.charCodeAt(0)}var punctuations=\"[~`!@#$%^&*(){}[];:\\\"'<,.>?/\\\\|-_+=\";function isPunctuation(t){return-1!==punctuations.indexOf(t)}var BertTokenizer=function(){function t(){}return t.prototype.load=function(){return __awaiter(this,void 0,void 0,function(){var t,e,n;return __generator(this,function(r){switch(r.label){case 0:return t=this,[4,this.loadVocab()];case 1:for(t.vocab=r.sent(),this.trie=new Trie,e=999;e<this.vocab.length;e++)n=this.vocab[e],this.trie.insert(n,1,e);return[2]}})})},t.prototype.loadVocab=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,util.fetch(VOCAB_URL).then(function(t){return t.json()})]})})},t.prototype.processInput=function(t){for(var e=this,n=[],r=0,o=this.cleanText(t,n).split(\" \").map(function(t){t=t.toLowerCase();var o=e.runSplitOnPunc(t,r,n);return r+=t.length+1,o}),i=[],s=0;s<o.length;s++)i=i.concat(o[s]);return i},t.prototype.cleanText=function(t,e){var n,r,o=[],i=0,s=0;try{for(var u=__values(t),a=u.next();!a.done;a=u.next()){var l=a.value;if(isInvalid(l))i+=l.length;else{if(isWhitespace(l)){if(!(o.length>0&&\" \"!==o[o.length-1])){i+=l.length;continue}o.push(\" \"),e[s]=i,i+=l.length}else o.push(l),e[s]=i,i+=l.length;s++}}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}return o.join(\"\")},t.prototype.runSplitOnPunc=function(t,e,n){var r,o,i=[],s=!0;try{for(var u=__values(t),a=u.next();!a.done;a=u.next()){var l=a.value;isPunctuation(l)?(i.push({text:l,index:n[e]}),e+=l.length,s=!0):(s&&(i.push({text:\"\",index:n[e]}),s=!1),i[i.length-1].text+=l,e+=l.length)}}catch(t){r={error:t}}finally{try{a&&!a.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}return i},t.prototype.tokenize=function(t){var e,n,r=[],o=this.processInput(t);o.forEach(function(t){t.text!==CLS_TOKEN&&t.text!==SEP_TOKEN&&(t.text=\"\"+SEPERATOR+t.text.normalize(NFKC_TOKEN))});for(var i=0;i<o.length;i++){var s=[];try{for(var u=(e=void 0,__values(o[i].text)),a=u.next();!a.done;a=u.next()){var l=a.value;s.push(l)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}for(var c=!1,h=0,f=[],p=s.length;h<p;){for(var d=p,_=void 0;h<d;){var v=s.slice(h,d).join(\"\"),g=this.trie.find(v);if(null!=g&&null!=g.end){_=g.getWord()[2];break}d-=1}if(null==_){c=!0;break}f.push(_),h=d}c?r.push(UNK_INDEX):r=r.concat(f)}return r},t}();function loadTokenizer(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,(t=new BertTokenizer).load()];case 1:return e.sent(),[2,t]}})})}var MODEL_URL=\"https://tfhub.dev/tensorflow/tfjs-model/mobilebert/1\",INPUT_SIZE=384,MAX_ANSWER_LEN=32,MAX_QUERY_LEN=64,MAX_SEQ_LEN=384,PREDICT_ANSWER_NUM=5,OUTPUT_OFFSET=1,NO_ANSWER_THRESHOLD=4.3980759382247925,QuestionAndAnswerImpl=function(){function t(t){this.modelConfig=t,null==this.modelConfig&&(this.modelConfig={modelUrl:MODEL_URL,fromTFHub:!0}),null==this.modelConfig.fromTFHub&&(this.modelConfig.fromTFHub=!1)}return t.prototype.process=function(t,e,n,r,o){void 0===o&&(o=128),t=(t=t.replace(/\\?/g,\"\")).trim(),t+=\"?\";var i=this.tokenizer.tokenize(t);if(i.length>n)throw new Error(\"The length of question token exceeds the limit (\"+n+\").\");for(var s=this.tokenizer.processInput(e.trim()),u=[],a=[],l=0;l<s.length;l++)for(var c=s[l].text,h=this.tokenizer.tokenize(c),f=0;f<h.length;f++){var p=h[f];u.push(l),a.push(p)}for(var d=r-i.length-3,_=[],v=0;v<a.length;){var g=a.length-v;if(g>d&&(g=d),_.push({start:v,length:g}),v+g===a.length)break;v+=Math.min(g,o)}return _.map(function(t){var e=[],n=[],o={};e.push(CLS_INDEX),n.push(0);for(var l=0;l<i.length;l++){var c=i[l];e.push(c),n.push(0)}e.push(SEP_INDEX),n.push(0);for(l=0;l<t.length;l++){var h=l+t.start,f=a[h];e.push(f),n.push(1),o[e.length]=u[h]}e.push(SEP_INDEX),n.push(1);for(var p=e,d=p.map(function(t){return 1});p.length<r;)p.push(0),d.push(0),n.push(0);return{inputIds:p,inputMask:d,segmentIds:n,origTokens:s,tokenToOrigMap:o}})},t.prototype.load=function(){return __awaiter(this,void 0,void 0,function(){var t,e,n,r,o;return __generator(this,function(i){switch(i.label){case 0:return t=this,[4,loadGraphModel(this.modelConfig.modelUrl,{fromTFHub:this.modelConfig.fromTFHub})];case 1:return t.model=i.sent(),e=ones([1,INPUT_SIZE],\"int32\"),n=ones([1,INPUT_SIZE],\"int32\"),r=ones([1,INPUT_SIZE],\"int32\"),this.model.execute({input_ids:e,segment_ids:n,input_mask:r,global_step:scalar(1,\"int32\")}),o=this,[4,loadTokenizer()];case 2:return o.tokenizer=i.sent(),[2]}})})},t.prototype.findAnswers=function(t,e){return __awaiter(this,void 0,void 0,function(){var n,r,o,i,s,u,a,l,c,h,f=this;return __generator(this,function(p){switch(p.label){case 0:if(null==t||null==e)throw new Error(\"The input to findAnswers call is null, please pass a string as input.\");return n=this.process(t,e,MAX_QUERY_LEN,MAX_SEQ_LEN),r=n.map(function(t){return t.inputIds}),o=n.map(function(t){return t.segmentIds}),i=n.map(function(t){return t.inputMask}),s=scalar(1,\"int32\"),u=n.length,a=tidy(function(){var t=tensor2d(r,[u,INPUT_SIZE],\"int32\"),e=tensor2d(o,[u,INPUT_SIZE],\"int32\"),n=tensor2d(i,[u,INPUT_SIZE],\"int32\");return f.model.execute({input_ids:t,segment_ids:e,input_mask:n,global_step:s},[\"start_logits\",\"end_logits\"])}),[4,Promise.all([a[0].array(),a[1].array()])];case 1:for(l=p.sent(),s.dispose(),a[0].dispose(),a[1].dispose(),c=[],h=0;h<u;h++)c.push(this.getBestAnswers(l[0][h],l[1][h],n[h].origTokens,n[h].tokenToOrigMap,e,h));return[2,c.reduce(function(t,e){return t.concat(e)},[]).sort(function(t,e){return e.score-t.score}).slice(0,PREDICT_ANSWER_NUM)]}})})},t.prototype.getBestAnswers=function(t,e,n,r,o,i){var s;void 0===i&&(i=0);var u=this.getBestIndex(t),a=this.getBestIndex(e),l=[];u.forEach(function(n){a.forEach(function(o){r[n]&&r[o]&&o>=n&&(o-n+1<MAX_ANSWER_LEN&&l.push({start:n,end:o,score:t[n]+e[o]}))})}),l.sort(function(t,e){return e.score-t.score});for(var c=[],h=0;h<l.length&&!(h>=PREDICT_ANSWER_NUM||l[h].score<NO_ANSWER_THRESHOLD);h++){var f=\"\",p=0,d=0;l[h].start>0?(f=(s=__read(this.convertBack(n,r,l[h].start,l[h].end,o),3))[0],p=s[1],d=s[2]):f=\"\",c.push({text:f,score:l[h].score,startIndex:p,endIndex:d})}return c},t.prototype.getBestIndex=function(t){for(var e=[],n=0;n<MAX_SEQ_LEN;n++)e.push([n,n,t[n]]);e.sort(function(t,e){return e[2]-t[2]});var r=[];for(n=0;n<PREDICT_ANSWER_NUM;n++)r.push(e[n][0]);return r},t.prototype.convertBack=function(t,e,n,r,o){var i=r+OUTPUT_OFFSET,s=e[n+OUTPUT_OFFSET],u=e[i],a=t[s].index,l=u<t.length-1?t[u+1].index-1:t[u].index+t[u].text.length;return[o.slice(a,l+1).trim(),a,l]},t}();function load(t){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(n){switch(n.label){case 0:return[4,(e=new QuestionAndAnswerImpl(t)).load()];case 1:return n.sent(),[2,e]}})})}var version=\"1.0.0\";export{load,version};\n"]},"metadata":{},"sourceType":"module"}